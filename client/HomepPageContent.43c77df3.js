import{c as P,g as v,a as B,i as l,b as y,d as b,s as h,e as A,t as p,f as I,h as j,r as R,j as k,k as F,l as M,F as T}from"./chunks/web.8a30961c.js";/* empty css                              */const D=e=>e.toLowerCase().replace(/\W/gi," ").replace(/\s+/g,"-"),H="https://api.themoviedb.org/3/genre/movie/list?api_key=163eabde6e8129fc03b71f3e1548d458&language=en-US",V=await fetch(H),W=await V.json(),[K]=P(W.genres),Y=p('<div class="movie-card"><div class="movie-poster"></div><div class="movie-info"><h3 class="movie-info__title"></h3><h6 class="movie-info__genres"></h6><!#><!/><p class="movie-info__description"></p><a class="movie-details">Show more</a></div></div>'),q=p("<a><img></a>"),z=p('<img alt="no poster found">'),J=p('<div class="movie-info__ratings"><span>\u2606</span><span class="movie-info__grade"></span></div>');function Q({data:e,favourites:t,index:a}){const s={},c="https://image.tmdb.org/t/p";function _($){return K(),null}return(()=>{const $=v(Y),S=$.firstChild,d=S.nextSibling,x=d.firstChild,U=x.nextSibling,r=U.nextSibling,[u,C]=B(r.nextSibling),g=u.nextSibling,w=g.nextSibling;return l(S,(()=>{const m=y(()=>!!e.poster_path);return()=>m()?(()=>{const i=v(q),o=i.firstChild;return b(n=>{const f=`/movie/${e.id}-${D(e.title)}`,E=`${c}/w185${e.poster_path}`,L=`${e.title} poster`;return f!==n._v$&&h(i,"href",n._v$=f),E!==n._v$2&&h(o,"src",n._v$2=E),L!==n._v$3&&h(o,"alt",n._v$3=L),n},{_v$:void 0,_v$2:void 0,_v$3:void 0}),i})():(()=>{const i=v(z);return b(()=>h(i,"src",{}.PUBLIC_NO_POSTER_URL)),i})()})()),l(x,()=>e.title),l(U,()=>_(e.genre_ids?e.genre_ids:e.genres)),l(d,(()=>{const m=y(()=>!!e.vote_average);return()=>m()&&(()=>{const i=v(J),o=i.firstChild,n=o.nextSibling;return l(n,()=>e.vote_average),b(()=>A(o,s[e.id]!==null&&s[e.id]||t?"movie-info__star added":"movie-info__star")),i})()})(),u,C),l(g,()=>e.overview),b(()=>h(w,"href",`/movie/${e.id}-${D(e.title)}`)),$})()}const X=p('<div class="searchBox"><input type="text" placeholder="search for a movie..."></div>');function Z({onInput:e}){return(()=>{const t=v(X),a=t.firstChild;return j(a,"input",e,!0),R(),t})()}I(["input"]);const G=(e,t)=>{const a=new URL({}.PUBLIC_MOVIE_DB_API_URL),s=new URL(`/3${e}`,a);if(s.searchParams.append("api_key",{}.PUBLIC_MOVIE_DB_API_KEY),s.searchParams.append("language","en-US"),t){for(const c in t)if(Object.prototype.hasOwnProperty.call(t,c)){const _=t[c];s.searchParams.append(c,_)}}return s},ee=e=>G("/movie/popular",{page:e}),te=({page:e,query:t}={page:1,query:""})=>G("/search/movie",{query:t,page:e,include_adult:!1}),N=async(e,t)=>await(await fetch(e,t)).json(),O=async(e=1)=>N(ee(e)),se=async e=>e?N(te({query:e,page:1})):Promise.resolve({}),ne=p('<div class="container"><h1 class="home-title">Popular Movies</h1><a href="/favourites" class="toFavouritesLink">Go to Favourites</a><div class="movies-list"></div><!#><!/></div>'),ie=p('<div class="wrapper"><button class="load-more">More</button></div>'),re=await O();function le(){const[e,t]=P(1),[a]=k(e,O),[s,c]=P(re),[_,$]=P(""),[S]=k(_,se);let d=0;F(()=>{if((a()?.page??0)>(s()?.page??1)){const r={...s(),page:e(),results:[...s().results,...a().results]};c(r)}});const x=()=>t(e()+1);return[M(Z,{onInput:r=>{clearTimeout(d);const u=r.currentTarget.value;d=setTimeout(()=>{$(u)},300)}}),(()=>{const r=v(ne),u=r.firstChild,C=u.nextSibling,g=C.nextSibling,w=g.nextSibling,[m,i]=B(w.nextSibling);return l(g,M(T,{get each(){return(_()?S():s())?.results},children:o=>M(Q,{data:o})})),l(r,(()=>{const o=y(()=>!_());return()=>o()?(()=>{const n=v(ie),f=n.firstChild;return f.$$click=x,b(()=>f.disabled=a.loading),R(),n})():null})(),m,i),r})()]}I(["click"]);export{le as HomePageContent};
